{% extends "layout.html" %}

{% block title %}
    List of Projects
{% endblock %}

{% block main %}

  <div class="container" id="projectsContainer">

    <!-- Form to search projects -->
    <form action="/projects" method="post" class="search-form" id="searchForm">

        <div class="row justify-content-center text-center gap-3">
          <div class="col-md-3 col-md">
            <label for="searchProjectName" class="form-text">Project's name</label>
            <input autocomplete="off" autofocus type="text" class="form-control" id="searchProjectName" name="searchProjectName">
          </div>

          <div class="col-md-3 col-md">
            <label for="searchProjectCategory" class="form-text">Category</label>
            <select class="form-select" id="searchProjectCategory" name="searchProjectCategory">
              <option selected>All</option>
              {% for category in categories_list %}
                <option> {{ category }} </option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-3 col-md">
            <label for="filter" class="form-text">Sort By</label>
            <select class="form-select" id="orderBy" name="orderBy">
              {% for status in status_list %}
                <option>{{ status | capitalize }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-2 col-md">
            <button action="/projects" method="post" type="submit" class="btn btn-outline-light search-button" id="searchButton">SEARCH</button>
          </div>

        </div>
    </form>

    <hr>

    <!-- Image cards -->
    <div class="row justify-content-center">
      {% for project in projects_list %}

        <div class="col-md-4 col-md">
          <div class="card">
            <img src="{{ url_for('static', filename='uploads/' + project['image_path']) }}" class="card-img" alt="project image">
            <div class="card-body d-flex">
              <p class="card-text my-auto w-50">{{ project["project_id"] }} {{ project["name"] }} | {{ project["category"] }}</p>
              <button class="btn btn-outline-dark" onclick="location.href='{{ url_for('project_page', project_id=project['project_id']) }}'">See project</button>
            </div>
            <div class="card-footer">
              {% if project["public_key"] == session["public_key"] %}
                <button disabled class="btn btn-primary btn-sm mb-2">Your project</button>
              {% endif %}
              <button disabled class="btn btn-dark btn-sm mb-2"> {{ project["days_left"] }}</button>
              <button disabled class="btn btn-success btn-sm mb-2">{{ project["funding_progress"] }} funded</button>
            </div>
          </div>
        </div>

        {% if (loop.index % 3 == 0) and (loop.index != 0) %}
          <div class="w-100 my-3"></div>
        {% endif %}

      {% endfor %}
    </div>
    
  </div>

{% endblock %}

